<!DOCTYPE html>
<html lang="pt-br">
<head>
  <%- include('partials/head') %>
  <title>HistÃ³rico de Compras - HealthPlus</title>
</head>
<body>
  <%- include('partials/navbar') %>

  <main class="container my-4">
    <h2>ğŸ§¾ HistÃ³rico de Compras</h2>

    <% if (historico.length === 0) { %>
      <p class="text-muted">VocÃª ainda nÃ£o fez nenhuma compra.</p>
    <% } else { %>
      <% historico.slice().reverse().forEach(pedido => { %>
        <div class="card mb-4 shadow-sm">
          <div class="card-body">
            <h5 class="card-title">Compra em <%= new Date(pedido.data).toLocaleString('pt-BR') %></h5>
            <p class="text-muted mb-2">Entregador: <%= pedido.entregador && pedido.entregador.nome ? pedido.entregador.nome : 'â€”' %> Â· VeÃ­culo: <%= pedido.entregador && pedido.entregador.veiculo ? pedido.entregador.veiculo : 'â€”' %></p>

            <ul class="list-group mb-3">
              <% pedido.itens.forEach(item => { %>
                <li class="list-group-item d-flex justify-content-between">
                  <div>
                    <strong><%= item.nome %></strong>
                    <div class="text-muted small">UnitÃ¡rio: R$ <%= Number(item.preco).toFixed(2) %> Â· Quantidade: <%= item.quantidade %></div>
                  </div>
                  <div>R$ <%= (Number(item.preco) * item.quantidade).toFixed(2) %></div>
                </li>
              <% }) %>
            </ul>
            <h6>Total: R$ <%= pedido.total.toFixed(2) %></h6>
          </div>
        </div>
      <% }) %>
    <% } %>

    <a href="/" class="btn btn-outline-secondary mt-3">â† Voltar para o inÃ­cio</a>
  </main>

  <%- include('partials/footer') %>
</body>
</html>
